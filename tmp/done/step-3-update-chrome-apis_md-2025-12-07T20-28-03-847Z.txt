<github_issue>
**Issue URL:** https://github.com/ziyaaktas/tab-limiter/issues/2

**Title:** Update Chrome APIs: browserAction → action and Callback → Promise Migration

**Body:**

## Summary

Migrate from deprecated Manifest V2 Chrome APIs to their MV3 equivalents and modernize the codebase to use native Promise-based APIs with async/await patterns.

## Background

As part of the Manifest V3 migration, Chrome Extension APIs have undergone significant changes:
- `chrome.browserAction` has been unified with `chrome.pageAction` into `chrome.action`
- MV3 provides native Promise support for most APIs, eliminating the need for callback patterns

## API Changes Required

### 1. browserAction → action

The `chrome.browserAction` API is renamed to `chrome.action` in MV3.

**Current code in `background.js`:**
```javascript
browser.browserAction.setBadgeText({ text: "" })
browser.browserAction.setBadgeText({ text: Math.min(...remaining).toString() })
```

**Required change:**
```javascript
chrome.action.setBadgeText({ text: "" })
chrome.action.setBadgeText({ text: Math.min(...remaining).toString() })
```

### 2. Callback → Promise Migration

Convert all callback-based API calls to use native Promises with async/await.

**Affected functions in `background.js`:**

| Function | Current Pattern | Target Pattern |
|----------|----------------|----------------|
| `tabQuery()` | Callback wrapped in Promise | Native async/await |
| `getOptions()` | Nested callbacks in Promise | Native async/await |
| `updateTabCount()` | Callback wrapped in Promise | Native async/await |
| `updateBadge()` | Promise chain | async/await |

**Affected functions in `options.js`:**

| Function | Current Pattern | Target Pattern |
|----------|----------------|----------------|
| `saveOptions()` | Callback | async/await |
| `restoreOptions()` | Nested callbacks | async/await |
| `updateBadge()` | Callback-style | async/await |

## Implementation Details

### background.js Changes

#### tabQuery() - Before:
```javascript
const tabQuery = (options, params = {}) => new Promise(res => {
	if (!options.countPinnedTabs) params.pinned = false
	browser.tabs.query(params, tabs => res(tabs))
})
```

#### tabQuery() - After:
```javascript
const tabQuery = async (options, params = {}) => {
	if (!options.countPinnedTabs) params.pinned = false
	return chrome.tabs.query(params)
}
```

#### getOptions() - Before:
```javascript
const getOptions = () => new Promise((res, rej) => {
	browser.storage.sync.get("defaultOptions", (defaults) => {
		browser.storage.sync.get(defaults.defaultOptions, (options) => {
			res(options);
		})
	})
})
```

#### getOptions() - After:
```javascript
const getOptions = async () => {
	const defaults = await chrome.storage.sync.get("defaultOptions")
	return chrome.storage.sync.get(defaults.defaultOptions)
}
```

#### updateBadge() - Before:
```javascript
const updateBadge = options => {
	if (!options.displayBadge) {
		browser.browserAction.setBadgeText({ text: "" })
		return;
	}
	Promise.all([windowRemaining(options), totalRemaining(options)])
	.then(remaining => {
		browser.browserAction.setBadgeText({
			text: Math.min(...remaining).toString()
		})
	})
}
```

#### updateBadge() - After:
```javascript
const updateBadge = async (options) => {
	if (!options.displayBadge) {
		await chrome.action.setBadgeText({ text: "" })
		return
	}
	const remaining = await Promise.all([windowRemaining(options), totalRemaining(options)])
	await chrome.action.setBadgeText({
		text: Math.min(...remaining).toString()
	})
}
```

### options.js Changes

#### saveOptions() - After:
```javascript
const saveOptions = async () => {
	const values = {}
	for (let i = 0; i < $inputs.length; i++) {
		const input = $inputs[i]
		const value = input.type === "checkbox" ? input.checked : input.value
		values[input.id] = value
	}
	await chrome.storage.sync.set(values)
	// Update status to let user know options were saved
	const status = document.getElementById('status')
	status.className = 'notice'
	status.textContent = 'Options saved.'
	setTimeout(() => {
		status.className += ' invisible'
	}, 100)
	await updateBadge(values)
}
```

#### restoreOptions() - After:
```javascript
const restoreOptions = async () => {
	const defaults = await chrome.storage.sync.get("defaultOptions")
	const options = await chrome.storage.sync.get(defaults.defaultOptions)
	for (let i = 0; i < $inputs.length; i++) {
		const input = $inputs[i]
		const valueType = input.type === "checkbox" ? "checked" : "value"
		input[valueType] = options[input.id]
	}
}
```

### Additional Modernization

1. **Remove browser compatibility shim**: The line `const browser = chrome || browser` can be simplified to use `chrome` directly since we're targeting Chrome specifically for MV3
2. **Add proper error handling**: Wrap async operations in try/catch blocks
3. **Use consistent async patterns**: Ensure all Promise-returning functions are marked `async`

## Acceptance Criteria

- [ ] All `chrome.browserAction` calls replaced with `chrome.action`
- [ ] All callback-based `chrome.storage.sync.get` calls converted to async/await
- [ ] All callback-based `chrome.storage.sync.set` calls converted to async/await
- [ ] All callback-based `chrome.tabs.query` calls converted to async/await
- [ ] All callback-based `chrome.tabs.remove` calls converted to async/await
- [ ] All callback-based `chrome.windows.create` calls converted to async/await
- [ ] `options.js` updated to use async/await patterns
- [ ] `background.js` updated to use async/await patterns
- [ ] Browser compatibility shim (`const browser = chrome || browser`) removed
- [ ] Error handling added with try/catch blocks where appropriate
- [ ] No remaining callback patterns in codebase (except event listeners)
- [ ] Extension tested and functions correctly after changes

## Technical References

- [chrome.action API](https://developer.chrome.com/docs/extensions/reference/api/action) - Official reference for the action API
- [Extension actions in Manifest V3](https://developer.chrome.com/blog/mv3-actions) - Blog post on action API changes
- [Update your code](https://developer.chrome.com/docs/extensions/develop/migrate/api-calls) - Official migration guide for API calls
- [Using promises](https://developer.chrome.com/docs/extensions/mv3/promises/) - Chrome documentation on Promise support

## Testing Considerations

1. Verify badge text updates correctly on tab creation/removal
2. Verify options save and restore correctly
3. Verify tab limits are enforced correctly
4. Test edge cases with pinned tabs
5. Verify alert messages display when limits are exceeded
</github_issue>

Issue created successfully at https://github.com/ziyaaktas/tab-limiter/issues/2 and moved to the "Todo" status in the tab-limiter project.
